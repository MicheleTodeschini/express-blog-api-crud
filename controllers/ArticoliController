
const articoliRicette = require('../data/ArticoliRicette')
const posts = require('../routers/posts')

const index = (req, res) => {

    res.json(articoliRicette)

    filteredArticle = articoliRicette

    if (req.query.tags) {
        console.log('trovato ');
        filteredArticle = articoliRicette.filter(articolo => articolo.tags.includes(tags))

    }
    res.json(filteredArticle)
}

const show = (req, res) => {
    const id = Number(req.params.id)
    console.log(id);

    const foundArticolo = articoliRicette.find(articolo => articolo.id === id)


    {/*    let foundArticolo = {}

    for (let i = 0; i < articoliRicette.length; i++) {
        if (articoliRicette[i].id === id) {
            foundArticolo = articoliRicette[i]

        }

    }*/}

    res.json(foundArticolo)
    console.log(foundArticolo);


}

const store = (req, res) => {
    const nuovoArticolo = {
        id: Date.now(),
        ...req.Body
    }

    console.log(nuovoArticolo);


    articoliRicette.push(nuovoArticolo)

    res.json(articoliRicette)
}

const update = (req, res) => {
    const id = Number(req.params.id)
    const postData = req.body

    const foundPost = articoliRicette.find(post => post.id === id)

    if (!foundPost) {
        return res.status(404).json({
            error: true,
            message: 'not found'
        })
    }

    articoliRicette.push(foundPost, postData)

    res.json(foundPost)

}

const modify = (req, res) => {
    res.send(`modify the post with id: ${req.params.id}`)
}

const destroy = (req, res) => {
    const id = Number(req.params.id)
    console.log(id);

    const foundArticolo = articoliRicette.find(articolo => articolo.id === id)

    articoliRicette.splice(articoliRicette.indexOf(foundArticolo), 1)
    console.log(articoliRicette);

    res.sendStatus(204)
}

module.exports = {
    index,
    show,
    store,
    update,
    modify,
    destroy
}